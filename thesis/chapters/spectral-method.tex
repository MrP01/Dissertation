\chapter{Spectral Method}
\label{chap:spectral-method}
In this chapter we will construct a spectral method in the basis of Jacobi polynomials to explore the solution of equilibrium distributions $\hat{\rho}(\hatvec{x})$.
Starting from a many-body system and considering the continuous limit as $N_p \goesto \infty$, in \Cref{chap:particle-interaction-theory} we have already established the governing equation of the particle density distribution $\hat{\rho}(\hatvec{x})$ in such a system.

As mentioned in \Cref{chap:particle-interaction-theory}, the numerical approaches will be carried out on the normalised domain $B_1(\vec{0})$ and we will be looking for $\rho \in \functionspace$, whilst in general we are interested in the $\hat{\rho} \in \functionspacehat$ solving \href{def:the-problem}{our problem}.
Both versions are related by $\hat{\rho}(\hatvec{x}) = \rho(\vec{x})$ and $\hatvec{x} := R \vec{x}$.

Can we put together a numerical method to solve for the equilibrium distribution (cf. \Cref{def:equilibrium-measure})?
Let us consider the problem from the bottom up and start from the solution:
The basic idea behind spectral methods is to assume a solution $\rho(\vec{x})$ of the form
$$\rho(\vec{x}) = \sum_{k=0}^{N-1} \rho_k \varphi_k(\vec{x})\,,\quad \rho_k \in \R, \varphi_k: \R^d \mapsto \R\,,\quad k = 0, ..., N-1\,,$$
with $N$ coefficients $\vec{\rho} := \left(\rho_0, ..., \rho_{N-1}\right)^T$ multiplying $N$ basis functions $\varphi_k$.

\pagebreak
\section{Special Functions}
The following section will introduce a few necessary objects and tools to understand the basis of functions we are working with to construct the spectral method, the basis of Jacobi polynomials.

We start with the Pochhammer symbol, another name for the \textit{rising factorial}, an unusual notation for a function but standard in the context of the special functions that will be introduced on top of it.
\input{chapters/bits/rising-factorial.tex}

As a second prerequisite, we introduce the closely intertwined beta- and gamma-functions (\Cref{def:beta-function}, \Cref{def:gamma-function}).
\input{chapters/bits/gamma-function.tex}
\input{chapters/bits/beta-function.tex}

Using the Pochhammer symbol introduced in \Cref{def:rising-factorial}, we can now define the generalised hypergeometric series ${}_pF_q$ (cf. \Cref{def:generalised-hypergeometric-series}) and a special case of it, the Gaussian hypergeometric function (cf. \Cref{lemma:gaussian-hypergeometric-function}).
\input{chapters/bits/generalised-hypergeometric-series.tex}
\input{chapters/bits/gaussian-hypergeometric-function.tex}

\pagebreak
\section{Orthogonal Polynomials Forming a Basis}
In order to efficiently construct a spectral method, we need an orthogonal basis.
\input{chapters/bits/orthogonal-polynomials.tex}
\input{chapters/bits/three-term-recurrence-relationship.tex}

The Jacobi polynomials are then defined from ${}_2F_1$ as follows:
\input{chapters/bits/jacobi-polynomials.tex}
% \input{chapters/bits/gegenbauer-polynomials.tex}
% \input{chapters/bits/chebyshev-polynomials.tex}
\input{chapters/bits/jacobi-matrix.tex}

% \pagebreak
\section{Working Towards a Solution}
Finally, now that we have established the basis functions, we can write down an ansatz $\rho: B_1(\vec{0}) \mapsto \R$ for the solution of \hyperref[def:the-problem]{the problem}, of the form
\begin{equation}
  \rho[\vec{\rho}](\vec{x}) = \rho(\vec{x}) := \left(1-\norm{\vec{x}}^{2}\right)^{m - \frac{\alpha + d}{2}} \sum_{k=0}^{N-1} \rho_k P_{k}^{\left(m - \frac{\alpha + d}{2},\frac{d-2}{2}\right)}(2 \norm{\vec{x}}^{2}-1)\,.
  \label{eq:ansatz}
\end{equation}
with $P_k^{(a, b)}$ the Jacobi polynomials and $\{\rho_k\}_{k=0, ..., N-1}$ the coefficients.
% TODO: is it alpha or beta in the exponent of (1-y\^{}2)?

The spectral method can then be written as a linear system of the coefficients $\vec{\rho}$ as we will see in the next section.
In order to establish said linear system, we first need to introduce the \textit{inverse fractional Laplacian}, helping us with the evaluation of the power law potential integral involving radial Jacobi polynomials given in \Cref{thm:theorem216}, the most important result of this chapter.

\input{chapters/bits/riesz-potential.tex}
\input{chapters/bits/theorem216.tex}

% \Cref{thm:theorem216} gives an explicit expression for the main integral \(\mathcal{Q}^{\beta}: L \mapsto L\), an operator from the function space \(L\) to the function space \(L\), we are interested in:
% which is used to construct the spectral method operator \(Q^\beta\) (cf. \Cref{def:power-law-operator}), acting on the coefficients \(\vec{\rho}\).

Adding to our collection of tools, in order to solve the problem given in \Cref{def:the-problem} we need to normalise the solution by its mass.
The normalisation constant is given in \Cref{lemma:mass}, based only on a single coefficient $\rho_0$, allowing for a highly efficient renormalisation.
\input{chapters/bits/mass-of-solution.tex}

\pagebreak
\section{Derivation of the Operator}
\input{chapters/bits/operator.tex}
\input{chapters/bits/derivation-of-operator-matrix.tex}
\input{chapters/bits/full-attrep-operator.tex}

\pagebreak
% Full Section:
\input{chapters/bits/solving-a-linear-system.tex}

\section{Results}
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{results/attrep/solution-increasing-order.pdf}
  \caption[Solutions of increasing orders]{Particle density distribution function solutions $\rho$ of increasing order $N$ to the attractive-repulsive problem with interaction potential $K_{alpha, \beta}(r)$, $\alpha = 2.5$ and $\beta = 1.2$. Reflected along the y-axis for better visibility of the domain.}
  \label{fig:solution-increasing-order}
\end{figure}

% Full Section:
\input{chapters/bits/outer-optimisation.tex}

\pagebreak
% Full Section:
\input{chapters/bits/comparison-with-analytic.tex}

\section{Discussion}
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{results/attrep/convergence.pdf}
  \caption[Step-by-step convergence of solutions compared to order 24]{Step-by-step convergence of numerical solutions $\rho_N(x)$ as compared to $\rho_{24}(x)$, visualised using the squared error of the pointwise evaluation of both functions in $200$ points.}
  \label{fig:convergence}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.9\linewidth]{results/attrep/varying-parameters.pdf}
  \caption[Varying parameters in the solver]{
    Varying different parameters in the solver to demonstrate their effect.
    See also, \Cref{fig:varying-R-solutions}.
  }
  \label{fig:varying-parameters}
\end{figure}
